<!DOCTYPE html>
<html>
<head>
    <title>LiveLite</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
     integrity="sha256-p4NxAoJBhIIN+hmNHrzRCf9tD/miZyoHS5obTRR9BMY="
     crossorigin=""/>
    <style>
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden;
        }
        
        #map {
            position: absolute;
            top: 50px; 
            left: 0;
            right: 0;
            bottom: 0;
            width: 100%; 
            height: calc(100% - 50px); 
        }

        .top-bar {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 30px;
            background-color: #f8f8f8;
            z-index: 1000;
            padding: 10px;
        }

        .top-bar button {
            padding: 3px 40px;
            font-size: 15px;
            font-family: 'Segoe UI', Verdana, sans-serif;
        }
    </style>
</head>
<body>
    <div class="top-bar">
    <button onclick="window.location.href='Listview.html'">List View</button>
    <button onclick="window.location.href='https://forms.gle/waeAtJZXPHfQZcMa6'">Add a Suggestion!</button>
    </div>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
     integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
     crossorigin=""></script>
    <div id="map"></div>
    <script>
        function getQueryParams() {
            const params = new URLSearchParams(window.location.search);
            return {
                lat: parseFloat(params.get("lat")),
                lng: parseFloat(params.get("lng")),
                zoom: parseInt(params.get("zoom"))
            };
        }

        var mapParams = getQueryParams();
        var map = L.map('map').setView(
            [mapParams.lat || -33.74, mapParams.lng || 151.10],
            mapParams.zoom || 11
        );

        L.tileLayer('https://tile.openstreetmap.org/{z}/{x}/{y}.png', {
            maxZoom: 19,
            attribution: '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>'
        }).addTo(map);

        var cheapPlaces = [
            { name: "Ronaldo + Co. Cooking", coords: [-33.713918, 151.084837]},
            { name: "Oriental Asian Cuisine", coords: [-33.702863, 151.101006]},
            { name: "YIYI Asian Cuisine", coords: [-33.425756, 151.344261]},
            { name: "Master Kebabs", coords: [-33.425402, 151.343888]},
            { name: "Wingboy Newtown", coords: [-33.8945, 151.1828]},
            { name: "Coho Berowra", coords: [-33.612826, 151.138754]},
            { name: "Mixue Ice cream and Tea", coords: [-33.704264, 151.100357]},
            { name: "Target Hornsby", coords: [-33.705257, 151.101164]},
            { name: "The Peak Cafe Newport", coords: [-33.653847, 151.32155]},
            { name: "Zeus St Greek", coords: [-33.732123, 151.128936]}
        ];

        cheapPlaces.forEach(function(place) {
    const marker = L.marker(place.coords).addTo(map)
        .bindPopup(`
            <b>${place.name}</b><br>
            <button onclick="window.location.href='Listview.html?lat=${place.coords[0]}&lng=${place.coords[1]}'">
                View in List
            </button>`);

            if (mapParams.lat === place.coords[0] && mapParams.lng === place.coords[1]) {
                marker.openPopup();
                map.setView(place.coords, mapParams.zoom || 14);
    }
});
            
        var popup = L.popup();

        function onMapClick(e) {
            popup
                .setLatLng(e.latlng)
                .setContent("You clicked the map at " + e.latlng.toString())
                .openOn(map);
        }

        map.on('click', onMapClick);
    </script>
</body>
</html>